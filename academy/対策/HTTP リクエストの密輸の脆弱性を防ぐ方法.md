# HTTP リクエストの密輸の脆弱性を防ぐ方法

- HTTP/2 エンドツーエンドを使用し、可能であれば HTTP ダウングレードを無効にします。HTTP/2 は、リクエストの長さを決定するための堅牢なメカニズムを使用しており、エンドツーエンドで使用すると、本質的にリクエストの密輸から保護されます。HTTP のダウングレードを回避できない場合は、書き換えられたリクエストが HTTP/1.1 仕様に照らして検証されていることを確認してください。たとえば、ヘッダーに改行、ヘッダー名にコロン、リクエスト メソッドにスペースが含まれるリクエストは拒否されます。

- フロントエンド サーバーがあいまいな要求を正規化し、バックエンド サーバーがまだあいまいな要求を拒否し、プロセス中の TCP 接続を閉じます。

- リクエストに本体がないと想定しないでください。これが、CL.0 とクライアント側の非同期の両方の脆弱性の根本的な原因です。

- リクエストの処理時にサーバーレベルの例外がトリガーされた場合、デフォルトでは接続が破棄されます。

- フォワード プロキシ経由でトラフィックをルーティングする場合は、可能であればアップストリーム HTTP/2 が有効になっていることを確認してください。
