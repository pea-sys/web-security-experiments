# ファイルアップロードの脆弱性を防ぐ方法

- 禁止されている拡張子のブラックリストではなく、許可されている拡張子のホワイトリストと照らし合わせてファイル拡張子を確認してください。攻撃者がどの拡張機能をアップロードしようとするかを推測するよりも、どの拡張機能を許可するかを推測する方がはるかに簡単です。
- ファイル名に、ディレクトリまたはトラバーサル シーケンス ( ../) として解釈される可能性のある部分文字列が含まれていないことを確認してください。
- 既存のファイルが上書きされる可能性がある衝突を避けるために、アップロードされたファイルの名前を変更します。
- ファイルが完全に検証されるまで、サーバーの永続ファイル システムにファイルをアップロードしないでください。
- ファイルのアップロードの前処理には、独自の検証メカニズムを作成するのではなく、できる限り確立されたフレームワークを使用してください。
