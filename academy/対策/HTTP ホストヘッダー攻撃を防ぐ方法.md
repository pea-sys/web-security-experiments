# HTTP ホストヘッダー攻撃を防ぐ方法

HTTP Host ヘッダー攻撃を防ぐ最も簡単な方法は、サーバー側のコードで Host ヘッダーの使用を完全に避けることです。絶対 URL より相対 URL を使用する方が、 Web キャッシュ ポイズニングの脆弱性を防ぐのに役立ちます。

HTTP ホスト ヘッダー攻撃を防ぐその他の方法には、次のようなものがあります。

## 絶対 URL を保護する

絶対 URL を使用する必要がある場合は、構成ファイルで現在のドメインを手動で指定し、Host ヘッダーの代わりにこの値を参照する必要があります。このアプローチにより、たとえばパスワード リセット ポイズニングの脅威が排除されます。

## ホストヘッダーを検証する

Host ヘッダーを使用する必要がある場合は、それが適切に検証されていることを確認してください。これには、許可されたドメインのホワイトリストと照合して、認識されないホストに対するリクエストを拒否またはリダイレクトする必要があります。これを行う方法については、フレームワークのドキュメントを参照してください。このアプローチにより、ホスト ヘッダー インジェクション攻撃にさらされる可能性が減ります。

## ホストオーバーライドヘッダーをサポートしない

これらの攻撃を構築するために使用される可能性のある追加のヘッダー、特に をサポートしていないことを確認することも重要です X-Forwarded-Host。これらはデフォルトでサポートされている可能性があることに注意してください。

## 許可されたドメインをホワイトリストに登録する

内部インフラストラクチャに対するルーティング ベースの攻撃を防ぐには、許可されたドメインのホワイトリストにのみリクエストを転送するようにロード バランサーまたはリバース プロキシを構成する必要があります。

## 内部専用の仮想ホストには注意してください

仮想ホスティングを使用する場合、内部専用の Web サイトやアプリケーションを公開コンテンツと同じサーバー上でホストすることは避けてください。そうしないと、攻撃者がホスト ヘッダー操作を介して内部ドメインにアクセスできる可能性があります。

[引用]  
https://portswigger.net/web-security/host-header#how-to-prevent-http-host-header-attacks
