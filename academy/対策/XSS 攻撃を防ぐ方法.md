# XSS 攻撃を防ぐ方法

- 到着時に入力をフィルターします。ユーザー入力を受信した時点で、期待される入力または有効な入力に基づいて可能な限り厳密にフィルタリングします。
- 出力時にデータをエンコードします。ユーザー制御可能なデータが HTTP 応答に出力される時点で、出力がアクティブ コンテンツとして解釈されないようにエンコードします。出力コンテキストによっては、HTML、URL、JavaScript、CSS エンコーディングの組み合わせを適用する必要がある場合があります。
- 適切な応答ヘッダーを使用します。HTML や JavaScript を含めることを意図していない HTTP 応答での XSS を防ぐには、Content-Type と X-Content-Type-Options ヘッダーを使用して、ブラウザーが意図した方法で応答を解釈できるようにします。
- コンテンツセキュリティポリシー。最後の防御線として、コンテンツ セキュリティ ポリシー (CSP) を使用して、依然として発生する XSS 脆弱性の重大度を軽減できます。

## XSS チートシート

https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
