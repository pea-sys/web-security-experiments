# CORS ベースの攻撃を防ぐ方法

- ### クロスオリジンリクエストの適切な構成

  Web リソースに機密情報が含まれている場合は、Access-Control-Allow-Origin ヘッダーで発信元を適切に指定する必要があります。

- ### 信頼できるサイトのみを許可する

  Access-Control-Allow-Origin ヘッダーで指定されるオリジンは、信頼できるサイトのみである必要があります。特に、検証を行わずにクロスオリジンリクエストからオリジンを動的に反映することは容易に悪用可能であるため、避けるべきです。

- ### ホワイトリストに null を登録しないようにする

  Access-Control-Allow-Origin: null ヘッダーの使用は避けてください 。内部ドキュメントおよびサンドボックス化されたリクエストからのクロスオリジン リソース呼び出しでは、null オリジンを指定できます。CORS ヘッダーは、プライベート サーバーとパブリック サーバーの信頼できるオリジンに関して適切に定義する必要があります。

- ### 内部ネットワークではワイルドカードを避ける

  内部ネットワークではワイルドカードを使用しないでください。内部ブラウザが信頼できない外部ドメインにアクセスできる場合、内部リソースを保護するためにネットワーク構成だけを信頼するだけでは十分ではありません。

- ### CORS はサーバー側のセキュリティ ポリシーの代替ではありません
  CORS はブラウザーの動作を定義するものであり、機密データのサーバー側保護に代わるものではありません。攻撃者は、信頼できる送信元からのリクエストを直接偽造することができます。したがって、Web サーバーは、適切に構成された CORS に加えて、認証やセッション管理などの機密データに対する保護を引き続き適用する必要があります。

(https://portswigger.net/web-security/cors#how-to-prevent-cors-based-attacks)
