# 認証セキュリティ対策

- ID または Password のどちらかを間違えた際に、エラーコードやエラー処理を統一すること。違いがあると ID を簡単に収集できてしまう。

- ID または Password を間違えた際の応答時間に大きな差異が生じない作りにすること。ID が存在しないと Password 検証しない場合に、意図的に Password を長くすることで処理時間の差異を元に ID が存在していることを気づかれる可能性がある。これにより ID を簡単に収集できてしまう。

* Password を Hash 関数で変換する場合、ソルトを使用すること。
  md5 や sha1 程度ならすぐ破られる。

* パスワードをリセットするより堅牢な方法は、パスワード リセット ページに移動する一意の URL をユーザーに送信すること

* 空のトークンを許容しないこと

* OAuth 暗黙的フローでは、POST リクエストはブラウザ経由で攻撃者に公開されます。その結果、クライアントがアクセストークンがリクエスト内の他のデータと一致するかどうかを適切にチェックしない場合、この動作は深刻な脆弱性につながる可能性がある

* OAuth を使用する際には State パラメータを使用すること

### ブルートフォース攻撃対策

- ログイン試行の失敗回数が多すぎる場合、リモート ユーザーがアクセスしようとしているアカウントをロックする
- リモート ユーザーが連続してあまりにも多くのログイン試行を行った場合、その IP アドレスをブロックする
  ※ただし、存在する ID のアクセス回数のみ計上するロジックだと ID の存在はばれてしまう
