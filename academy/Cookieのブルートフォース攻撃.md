# Cookie のブルートフォース攻撃

今回はクッキーに対してブルートフォース攻撃します。
もちろん、暗号アルゴリズムや、そこに含まれる情報が脆弱な場合にのみ
この攻撃は意味を持ちます。

- 1.  Burp Suite を起動します
- 2.  Burp Suite からブラウザを起動し、自分で作成したアカウントにログインします。ログインする際には、ログイン情報を記憶するチェックボックスをチェックし、クッキーを生成します。

- 3. 2 のログインから得たクッキーからクッキーの生成ルールを推測します。  
     今回はたまたま脆弱な作りとして、クッキーは以下とします。

```
「base64(username+':'+md5HashOfPassword)」
```

※Web サイト作成サイドは、このタイミングで推測させないことが大事です

- 4. 2 のログインの結果を Send to intruder
     ![1](https://github.com/pea-sys/Til/assets/49807271/16605448-bfce-4c51-ba9a-903156cb727c)
- 5. Send to intruder タブに移動
- 6. リクエストにアカウント文字列が含まれていれば攻撃対象アカウントに置き換えます。クッキーは不明なパスワードを含むので、ブルートフォース攻撃のためにパラメータ化します
     ![2](https://github.com/pea-sys/Til/assets/49807271/400f6fd4-bd14-40ca-aaa4-fd15f6c4af4a)
- 7. Payload Process の項目で パラメータに md5 適用後、username を付加したものを base64 で変換するようにセットします
     ![3](https://github.com/pea-sys/Til/assets/49807271/9973b325-1127-4818-8725-3c83a8fc238e)
- 8. 今回はリスト攻撃するので、リストを張り付けて攻撃を開始します。

これはハッキングラボの手順です。実際には 3 のクッキー生成のルールの推測は多くの試行と経験を必要としそうです。
